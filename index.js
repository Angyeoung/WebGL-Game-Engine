var f=class o{x;y;z;constructor(t,r,e){this.x=t,this.y=r,this.z=e}static get zero(){return new o(0,0,0)}static get one(){return new o(1,1,1)}static get up(){return new o(0,1,0)}static get down(){return new o(0,-1,0)}static get right(){return new o(1,0,0)}static get left(){return new o(-1,0,0)}static get forward(){return new o(0,0,1)}static get back(){return new o(0,0,-1)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}static copy(t,r){return r=r||new o(0,0,0),r.x=t.x,r.y=t.y,r.z=t.z,r}static transform(t,r,e){e=e||new o(0,0,0);let n=t.x*r[0]+t.y*r[4]+t.z*r[8]+r[12],i=t.x*r[1]+t.y*r[5]+t.z*r[9]+r[13],a=t.x*r[2]+t.y*r[6]+t.z*r[10]+r[14],c=t.x*r[3]+t.y*r[7]+t.z*r[11]+r[15];return e.x=n/c,e.y=i/c,e.z=a/c,e}static cross(t,r,e){e=e||new o(0,0,0);let n=t.z*r.x-t.x*r.z,i=t.x*r.y-t.y*r.x;return e.x=t.y*r.z-t.z*r.y,e.y=n,e.z=i,e}static dot(t,r){return t.x*r.x+t.y*r.y+t.z*r.z}static equals(t,r){return t.x!==r.x||t.y!==r.y||t.z!==r.z}static sub(t,r,e){return e=e||new o(0,0,0),e.x=t.x-r.x,e.y=t.y-r.y,e.z=t.z-r.z,e}static add(t,r,e){return e=e||new o(0,0,0),e.x=t.x+r.x,e.y=t.y+r.y,e.z=t.z+r.z,e}static scale(t,r,e){return e=e||new o(0,0,0),e.x=t.x*r,e.y=t.y*r,e.z=t.z*r,e}static normalize(t,r){r=r||new o(0,0,0);let e=1/t.magnitude;return r.x=t.x*e,r.y=t.y*e,r.z=t.z*e,r}static f32(t,r){return r=r||new Float32Array(3),r[0]=t.x,r[1]=t.y,r[2]=t.z,r}},A=class o{static zero(t){return t=t||new Float32Array(16),t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=0,t}static identity(t){return t=o.zero(t),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}static setScalar(t,r){return r=r||new Float32Array(16),o.identity(r),r[0]=t.x,r[5]=t.y,r[10]=t.z,r}static lookAt(t,r,e=f.up,n){n=n||o.identity();let i=f.sub(r,t);f.normalize(i,i);let a=f.cross(e,i);f.normalize(a,a);let c=f.cross(i,a);return f.normalize(c,c),n[0]=a.x,n[1]=c.x,n[2]=i.x,n[4]=a.y,n[5]=c.y,n[6]=i.y,n[8]=a.z,n[9]=c.z,n[10]=i.z,n[12]=-f.dot(a,t),n[13]=-f.dot(c,t),n[14]=-f.dot(i,t),n}static perspectiveFovLH(t,r,e,n,i){i=i||o.identity();let a=1/Math.tan(t*.5);return i[0]=a/r,i[5]=a,i[10]=-n/(e-n),i[11]=1,i[14]=e*n/(e-n),i[15]=0,i}static rotate(t,r){return o.rotateX(t,r.x),o.rotateY(t,r.y),o.rotateZ(t,r.z),t}static rotateX(t,r){let e=E(r),n=Math.sin(e),i=Math.cos(e);return o.multiply(t,new Float32Array([1,0,0,0,0,i,n,0,0,-n,i,0,0,0,0,1]),t),t}static rotateY(t,r){let e=E(r),n=Math.sin(e),i=Math.cos(e);return o.multiply(t,new Float32Array([i,0,-n,0,0,1,0,0,n,0,i,0,0,0,0,1]),t)}static rotateZ(t,r){let e=E(r),n=Math.sin(e),i=Math.cos(e);return o.multiply(t,new Float32Array([i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1]),t)}static translation(t,r){return r=r||o.identity(),r[12]=t.x,r[13]=t.y,r[14]=t.z,r}static multiply(t,r,e){e=e||new Float32Array(16);let n=t[0]*r[0]+t[1]*r[4]+t[2]*r[8]+t[3]*r[12],i=t[0]*r[1]+t[1]*r[5]+t[2]*r[9]+t[3]*r[13],a=t[0]*r[2]+t[1]*r[6]+t[2]*r[10]+t[3]*r[14],c=t[0]*r[3]+t[1]*r[7]+t[2]*r[11]+t[3]*r[15];return e[0]=n,e[1]=i,e[2]=a,e[3]=c,n=t[4]*r[0]+t[5]*r[4]+t[6]*r[8]+t[7]*r[12],i=t[4]*r[1]+t[5]*r[5]+t[6]*r[9]+t[7]*r[13],a=t[4]*r[2]+t[5]*r[6]+t[6]*r[10]+t[7]*r[14],c=t[4]*r[3]+t[5]*r[7]+t[6]*r[11]+t[7]*r[15],e[4]=n,e[5]=i,e[6]=a,e[7]=c,n=t[8]*r[0]+t[9]*r[4]+t[10]*r[8]+t[11]*r[12],i=t[8]*r[1]+t[9]*r[5]+t[10]*r[9]+t[11]*r[13],a=t[8]*r[2]+t[9]*r[6]+t[10]*r[10]+t[11]*r[14],c=t[8]*r[3]+t[9]*r[7]+t[10]*r[11]+t[11]*r[15],e[8]=n,e[9]=i,e[10]=a,e[11]=c,n=t[12]*r[0]+t[13]*r[4]+t[14]*r[8]+t[15]*r[12],i=t[12]*r[1]+t[13]*r[5]+t[14]*r[9]+t[15]*r[13],a=t[12]*r[2]+t[13]*r[6]+t[14]*r[10]+t[15]*r[14],c=t[12]*r[3]+t[13]*r[7]+t[14]*r[11]+t[15]*r[15],e[12]=n,e[13]=i,e[14]=a,e[15]=c,e}static invert(t,r){r=r||new Float32Array(16);let e=t[0],n=t[1],i=t[2],a=t[3],c=t[4],y=t[5],m=t[6],x=t[7],p=t[8],F=t[9],L=t[10],U=t[11],w=t[12],z=t[13],g=t[14],S=t[15],u=L*S-U*g,R=F*S-U*z,G=F*g-L*z,T=p*S-U*w,v=p*g-L*w,W=p*z-F*w,O=y*u-m*R+x*G,N=-(c*u-m*T+x*v),j=c*R-y*T+x*W,D=-(c*G-y*v+m*W),l=1/(e*O+n*N+i*j+a*D),H=m*S-x*g,Y=y*S-x*z,d=y*g-m*z,k=c*S-x*w,q=c*g-m*w,X=c*z-y*w,K=m*U-x*L,Z=y*U-x*F,J=y*L-m*F,Q=c*U-x*p,$=c*L-m*p,tt=c*F-y*p;return r[0]=O*l,t[4]=N*l,r[8]=j*l,t[12]=D*l,r[1]=-(n*u-i*R+a*G)*l,r[5]=(e*u-i*T+a*v)*l,r[9]=-(e*R-n*T+a*W)*l,r[13]=(e*G-n*v+i*W)*l,r[2]=(n*H-i*Y+a*d)*l,r[6]=-(e*H-i*k+a*q)*l,r[10]=(e*Y-n*k+a*X)*l,r[14]=-(e*d-n*q+i*X)*l,r[3]=-(n*K-i*Z+a*J)*l,r[7]=(e*K-i*Q+a*$)*l,r[11]=-(e*Z-n*Q+a*tt)*l,r[15]=(e*J-n*$+i*tt)*l,r}static copy(t,r){return t===r||(r=r||new Float32Array(16),r.set(t)),r}static transpose(t,r){if(r=r||new Float32Array(16),r===t){let u;return u=t[1],t[1]=t[4],t[4]=u,u=t[2],t[2]=t[8],t[8]=u,u=t[3],t[3]=t[12],t[12]=u,u=t[6],t[6]=t[9],t[9]=u,u=t[7],t[7]=t[13],t[13]=u,u=t[11],t[11]=t[14],t[14]=u,r}let e=t[0],n=t[1],i=t[2],a=t[3],c=t[4],y=t[5],m=t[6],x=t[7],p=t[8],F=t[9],L=t[10],U=t[11],w=t[12],z=t[13],g=t[14],S=t[15];return r[0]=e,r[1]=c,r[2]=p,r[3]=w,r[4]=n,r[5]=y,r[6]=F,r[7]=z,r[8]=i,r[9]=m,r[10]=L,r[11]=g,r[12]=a,r[13]=x,r[14]=U,r[15]=S,r}};function E(o){return o*(Math.PI/180)}var V=class{worldNeedsUpdate=!0;viewNeedsUpdate=!0;worldMatrix=A.identity();viewMatrix=A.identity();position=f.zero;rotation=f.zero;scale=f.one;mesh;name;constructor(t){this.name=t}setMesh(t){return this.mesh=t,this}setPosition(t){this.worldNeedsUpdate=!0,this.viewNeedsUpdate=!0,this.position.x=t.x,this.position.y=t.y,this.position.z=t.z}setRotation(t){this.worldNeedsUpdate=!0,this.viewNeedsUpdate=!0,this.rotation.x=t.x,this.rotation.y=t.y,this.rotation.z=t.z}getWorldMatrix(){return this.worldNeedsUpdate&&(A.setScalar(this.scale,this.worldMatrix),A.rotate(this.worldMatrix,this.rotation),A.multiply(this.worldMatrix,A.translation(this.position),this.worldMatrix),this.worldNeedsUpdate=!1),this.worldMatrix}getViewMatrix(){return this.viewNeedsUpdate&&(A.lookAt(this.position,f.zero,void 0,this.viewMatrix),this.viewNeedsUpdate=!1),this.viewMatrix}};var M=class extends V{projectionUpdated=!0;projectionMatrix=A.identity();fov;near;far;constructor(t){super(t),this.fov=.9,this.near=.1,this.far=2e4,globalThis.addEventListener("resize",()=>this.projectionUpdated=!0)}get aspect(){return globalThis.innerWidth/globalThis.innerHeight}getProjectionMatrix(){return this.projectionUpdated&&(A.perspectiveFovLH(this.fov,this.aspect,this.near,this.far,this.projectionMatrix),this.projectionUpdated=!1),this.projectionMatrix}};var h=class{static createProgramInfo(t,r=or,e=nr){let n=st(t,r,e),i=ft(t,n);return{program:n,uniformInfo:i,attributeInfo:{}}}static setUniforms(t,r){for(let[e,n]of Object.entries(r)){if(!(e in t.uniformInfo)){console.error("Invalid uniform: "+e);continue}t.uniformInfo[e].setter(n)}}static getContext(t){let r=t.getContext("webgl2");if(!r)throw new Error("Failed to get WebGL2 context of canvas");return r}static VAO(t,r,e){let n=t.createVertexArray();if(!n)throw new Error("Unable to create vao");return t.bindVertexArray(n),t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ARRAY_BUFFER,e.vertices,t.STATIC_DRAW),_(t,r,"a_position",3,t.FLOAT,!1,3*4,0),t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ARRAY_BUFFER,e.normals,t.STATIC_DRAW),_(t,r,"a_normal",3,t.FLOAT,!1,3*4,0),e.uvs?.length&&(t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ARRAY_BUFFER,e.uvs,t.STATIC_DRAW),_(t,r,"a_texCoord",2,t.FLOAT,!0,2*4,0)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.triangles,t.STATIC_DRAW),n}};function _(o,t,r,e,n,i,a,c){let y=o.getAttribLocation(t,r);o.vertexAttribPointer(y,e,n,i,a,c),o.enableVertexAttribArray(y)}function st(o,t,r){let e=o.createProgram();if(!e)throw new Error("Unable to create Program");return rt(o,e,t,mt),rt(o,e,r,At),o.linkProgram(e),o.validateProgram(e),o.getProgramParameter(e,lt)||console.error(`Program linking failed:

`,o.getProgramInfoLog(e)),o.getProgramParameter(e,yt)||console.error(`Program validation failed:

`,o.getProgramInfoLog(e)),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.frontFace(o.CW),o.cullFace(o.BACK),o.useProgram(e),e}function rt(o,t,r,e){let n=o.createShader(e);if(!n)throw new Error("Unable to create Shader");if(o.shaderSource(n,r),o.compileShader(n),!o.getShaderParameter(n,ut))throw new Error(`Unable to compile Shader.

`+o.getShaderInfoLog(n));return o.attachShader(t,n),n}function ft(o,t){let r={},e=o.getProgramParameter(t,o.ACTIVE_UNIFORMS);for(let n=0;n<e;n++){let i=o.getActiveUniform(t,n);if(!i)continue;let a=o.getUniformLocation(t,i.name);r[i.name]={location:o.getUniformLocation(t,i.name),setter:s[i.type].setter(o,a)}}return r}var ut=35713,lt=35714,yt=35715,At=35632,mt=35633,xt=5126,ht=35664,pt=35665,Ft=35666,Lt=5124,Ut=35667,wt=35668,zt=35669,gt=35670,St=35671,Vt=35672,bt=35673,Mt=35674,Ct=35685,Rt=35686,Gt=35675,Tt=35687,vt=35688,Wt=35676,It=35689,Et=35690,_t=5125,Bt=36294,Pt=36295,Ot=36296,s={};s[xt]={type:Float32Array,size:4,setter:Nt,cols:1};s[ht]={type:Float32Array,size:8,setter:jt,cols:2};s[pt]={type:Float32Array,size:12,setter:Dt,cols:3};s[Ft]={type:Float32Array,size:16,setter:Ht,cols:4};s[Lt]={type:Int32Array,size:4,setter:et,cols:1};s[Ut]={type:Int32Array,size:8,setter:ot,cols:2};s[wt]={type:Int32Array,size:12,setter:nt,cols:3};s[zt]={type:Int32Array,size:16,setter:it,cols:4};s[_t]={type:Uint32Array,size:4,setter:Yt,cols:1};s[Bt]={type:Uint32Array,size:8,setter:dt,cols:2};s[Pt]={type:Uint32Array,size:12,setter:kt,cols:3};s[Ot]={type:Uint32Array,size:16,setter:qt,cols:4};s[gt]={type:Uint32Array,size:4,setter:et,cols:1};s[St]={type:Uint32Array,size:8,setter:ot,cols:2};s[Vt]={type:Uint32Array,size:12,setter:nt,cols:3};s[bt]={type:Uint32Array,size:16,setter:it,cols:4};s[Mt]={type:Float32Array,size:32,setter:Xt,rows:2,cols:2};s[Gt]={type:Float32Array,size:48,setter:Kt,rows:3,cols:3};s[Wt]={type:Float32Array,size:64,setter:Zt,rows:4,cols:4};s[Ct]={type:Float32Array,size:32,setter:Jt,rows:2,cols:3};s[Rt]={type:Float32Array,size:32,setter:$t,rows:2,cols:4};s[Tt]={type:Float32Array,size:48,setter:Qt,rows:3,cols:2};s[vt]={type:Float32Array,size:48,setter:rr,rows:3,cols:4};s[It]={type:Float32Array,size:64,setter:tr,rows:4,cols:2};s[Et]={type:Float32Array,size:64,setter:er,rows:4,cols:3};function Nt(o,t){return function(r){o.uniform1fv(t,r)}}function jt(o,t){return function(r){o.uniform2fv(t,r)}}function Dt(o,t){return function(r){o.uniform3fv(t,r)}}function Ht(o,t){return function(r){o.uniform4fv(t,r)}}function et(o,t){return function(r){o.uniform1iv(t,r)}}function ot(o,t){return function(r){o.uniform2iv(t,r)}}function nt(o,t){return function(r){o.uniform3iv(t,r)}}function it(o,t){return function(r){o.uniform4iv(t,r)}}function Yt(o,t){return function(r){o.uniform1uiv(t,r)}}function dt(o,t){return function(r){o.uniform2uiv(t,r)}}function kt(o,t){return function(r){o.uniform3uiv(t,r)}}function qt(o,t){return function(r){o.uniform4uiv(t,r)}}function Xt(o,t){return function(r){o.uniformMatrix2fv(t,!1,r)}}function Kt(o,t){return function(r){o.uniformMatrix3fv(t,!1,r)}}function Zt(o,t){return function(r){o.uniformMatrix4fv(t,!1,r)}}function Jt(o,t){return function(r){o.uniformMatrix2x3fv(t,!1,r)}}function Qt(o,t){return function(r){o.uniformMatrix3x2fv(t,!1,r)}}function $t(o,t){return function(r){o.uniformMatrix2x4fv(t,!1,r)}}function tr(o,t){return function(r){o.uniformMatrix4x2fv(t,!1,r)}}function rr(o,t){return function(r){o.uniformMatrix3x4fv(t,!1,r)}}function er(o,t){return function(r){o.uniformMatrix4x3fv(t,!1,r)}}var or=`#version 300 es
    in vec3 a_position;
    in vec3 a_normal;

    uniform mat4 u_world;
    uniform mat4 u_view;
    uniform mat4 u_proj;

    out vec3 v_normal;

    void main() {
        v_normal = a_normal;
        gl_Position = u_proj * u_view * u_world * vec4(a_position, 1.0);
    }
`,nr=`#version 300 es
    precision mediump float;

    in vec3 v_normal;

    out vec4 f_color;

    void main() {
        vec3 normal = normalize(v_normal);
        f_color = vec4(normal, 1.0); 
    }
`;var I=class{gl;canvas;programInfo;constructor(t){this.canvas=t,this.gl=h.getContext(t),this.programInfo=h.createProgramInfo(this.gl),this.gl.clearColor(.3,.6,.8,1),this.resizeCanvas(),globalThis.addEventListener("resize",()=>this.resizeCanvas)}render(t,r){this.gl.clear(this.gl.COLOR_BUFFER_BIT),h.setUniforms(this.programInfo,{u_view:r.getViewMatrix(),u_proj:r.getProjectionMatrix()});for(let e of t.objects)e.mesh&&(e.mesh.vao||(e.mesh.vao=h.VAO(this.gl,this.programInfo.program,e.mesh)),h.setUniforms(this.programInfo,{u_world:e.getWorldMatrix()}),this.gl.bindVertexArray(e.mesh.vao),this.gl.drawElements(this.gl.TRIANGLES,e.mesh.triangles.length,this.gl.UNSIGNED_SHORT,0))}resizeCanvas(t=1){this.gl.canvas.width=globalThis.innerWidth*t,this.gl.canvas.height=globalThis.innerHeight*t,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}};var b=class o{vertices;normals;triangles;uvs;vao;constructor(t,r,e){this.vertices=t,this.normals=r,this.triangles=e}static Cube(){let t=new Float32Array([-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5]),r=new Float32Array([-1,-1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,1,-1,1,1,1,-1,1,1,1,1]),e=new Uint16Array([0,1,3,0,3,2,2,3,7,2,7,6,6,7,5,6,5,4,4,5,1,4,1,0,1,5,7,1,7,3,4,0,3,4,3,6]);return new o(t,r,e)}static Pyramid(){let t=new Float32Array([0,.5,0,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5]),r=new Float32Array([0,1,0,-1,0,1,1,0,1,1,0,-1,-1,0,-1]),e=new Uint16Array([0,1,2,0,2,3,0,3,4,0,4,1,1,4,2,2,4,3]);return new o(t,r,e)}};var C=class{objects=[];constructor(...t){for(let r of t)this.add(r)}add(t){this.objects.push(t)}};var ir=new I(document.querySelector("canvas")),at=new M("main"),B=new V("coob").setMesh(b.Cube()),P=new V("pymid").setMesh(b.Pyramid()),ar=new C(B,P);at.setPosition(new f(0,0,-6));B.setPosition(new f(1,0,0));P.setPosition(new f(-1,0,0));function ct(o){B.setRotation(new f(0,o/10,0)),P.setRotation(new f(0,-o/10,0)),ir.render(ar,at),requestAnimationFrame(ct)}requestAnimationFrame(ct);
//# sourceMappingURL=index.js.map
